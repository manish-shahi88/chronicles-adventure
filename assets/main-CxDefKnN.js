var vi=Object.defineProperty;var Si=(i,t,o)=>t in i?vi(i,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[t]=o;var h=(i,t,o)=>Si(i,typeof t!="symbol"?t+"":t,o);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))p(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const k of l.addedNodes)k.tagName==="LINK"&&k.rel==="modulepreload"&&p(k)}).observe(document,{childList:!0,subtree:!0});function o(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function p(a){if(a.ep)return;a.ep=!0;const l=o(a);fetch(a.href,l)}})();const Ii="/chronicles-adventure/images/platform.png",Ei="/chronicles-adventure/images/background.png",Ci="/chronicles-adventure/images/tree.png",Wi="/chronicles-adventure/images/background%204.png",Ti="/chronicles-adventure/sounds/zombieSound.mp3",Hi="/chronicles-adventure/sounds/backgroundMusic.mp3",bi="/chronicles-adventure/sounds/soldierScream.mp3",j="/chronicles-adventure/sounds/deathSound.mp3",Li="/chronicles-adventure/sounds/gunfire.mp3",Pi="/chronicles-adventure/sounds/explosion.mp3";class d{constructor({x:t,y:o,image:p}){h(this,"position");h(this,"image");h(this,"width");h(this,"height");this.position={x:t,y:o},this.image=p,this.width=s.width/2,this.height=p.height}draw(){r.drawImage(this.image,this.position.x,this.position.y,this.width,this.height)}}const Q=.5,n=150,y=500,x=6,ti=1,F=14e3,ki=300,Ai=400,ei=50,Oi="/chronicles-adventure/images/sprite.png",Xi="/chronicles-adventure/images/spriteFlip.png";let O=new Image;O.src=Oi;let q=new Image;q.src=Xi;class Yi{constructor(){h(this,"position");h(this,"velocity");h(this,"width");h(this,"height");h(this,"image");h(this,"frame");h(this,"frameInterval");h(this,"frameTimer");h(this,"sprites");h(this,"currentSprite");h(this,"currentCroppWidth");h(this,"currentCropHeight");h(this,"cropWidth");h(this,"cropHeight");this.position={x:100,y:100},this.velocity={x:0,y:1},this.width=50,this.height=70,this.image=O,this.frame=0,this.frameInterval=2,this.frameTimer=0,this.sprites={stand:{right:O},run:{right:O},runLeft:{left:q},shootRight:{right:O},shootLeft:{left:q}},this.currentSprite=this.sprites.run.right,this.currentCroppWidth=290,this.currentCropHeight=65,this.cropWidth=87,this.cropHeight=130}draw(){r.drawImage(this.currentSprite,this.currentCroppWidth,this.currentCropHeight,this.cropWidth,this.cropHeight,this.position.x,this.position.y,this.width,this.height)}update(){this.frameTimer++,w.d.pressed&&this.currentSprite===this.sprites.run.right?(this.frameTimer>=this.frameInterval&&(this.currentCroppWidth=260+192*this.frame,this.frame++,this.frame>7&&(this.frame=0),this.frameTimer=0),this.currentCropHeight=531):w.a.pressed&&this.currentSprite===this.sprites.runLeft.left?(this.frameTimer>=this.frameInterval&&(this.currentCroppWidth=110+193*this.frame,this.frame++,this.frame>7&&(this.frame=0),this.frameTimer=0),this.currentCropHeight=531):w.shoot.pressed&&this.currentSprite===this.sprites.shootRight.right?(this.currentCroppWidth=668,this.currentCropHeight=732,this.cropWidth=110):w.shoot.pressed&&this.currentSprite===this.sprites.shootLeft.left?(this.currentCroppWidth=996,this.currentCropHeight=732,this.cropWidth=110):w.shoot.pressed===!1&&this.currentSprite===this.sprites.shootRight.right?this.currentCroppWidth=260:w.shoot.pressed===!1&&this.currentSprite===this.sprites.shootLeft.left&&(this.currentCroppWidth=258,this.currentCropHeight=64),this.draw(),this.position.x+=this.velocity.x,this.position.y+=this.velocity.y,this.position.y+this.height+this.velocity.y<s.height&&(this.velocity.y+=Q)}getPosition(){return this.position}}class u{constructor({x:t,y:o,image:p}){h(this,"position");h(this,"image");h(this,"width");h(this,"height");this.position={x:t,y:o},this.image=p,this.width=p.width,this.height=p.height}draw(){r.drawImage(this.image,this.position.x,this.position.y,this.width,this.height)}}const Fi="/chronicles-adventure/images/bullet.png",di=new Image;di.src=Fi;class hi{constructor(t,o,p,a){h(this,"position");h(this,"velocity");h(this,"width");h(this,"height");this.position=t,this.velocity=o,this.width=p,this.height=a}draw(){r.beginPath(),r.drawImage(di,this.position.x,this.position.y-c.height*2/8,this.width,this.height),r.closePath()}update(){this.draw(),this.position.x+=this.velocity.velocityX,this.position.y+=this.velocity.velocityY}}const ji="/chronicles-adventure/images/enemy.png";let z=new Image;z.src=ji;class M{constructor({x:t,y:o}){h(this,"position");h(this,"velocity");h(this,"width");h(this,"height");h(this,"image");h(this,"frame");h(this,"frameInterval");h(this,"frameTimer");h(this,"currentSprite");h(this,"currentCroppWidth");h(this,"currentCropHeight");h(this,"cropWidth");h(this,"cropHeight");this.position={x:t,y:o},this.velocity={x:1,y:1},this.width=50,this.height=70,this.image=z,this.frame=0,this.frameInterval=10,this.frameTimer=0,this.currentSprite=z,this.currentCroppWidth=87,this.currentCropHeight=0,this.cropWidth=99,this.cropHeight=131}draw(){r.drawImage(this.currentSprite,this.currentCroppWidth,this.currentCropHeight,this.cropWidth,this.cropHeight,this.position.x,this.position.y,this.width,this.height)}update(){this.draw(),this.frameTimer++,this.frameTimer>=this.frameInterval&&(this.currentCroppWidth=105+147*this.frame,this.frame++,this.frame>10&&(this.frame=0),this.frameTimer=0),this.position.x+=this.velocity.x,this.position.y+=this.velocity.y,this.position.y+this.height+this.velocity.y<s.height&&(this.velocity.y+=Q)}getPosition(){return this.position}}const Di="/chronicles-adventure/images/stone.png";let li=new Image;li.src=Di;class Ri{constructor(t,o,p,a){h(this,"position");h(this,"velocity");h(this,"width");h(this,"height");h(this,"rotation");this.position=t,this.velocity=o,this.width=p,this.height=a,this.rotation=0}draw(){r.save(),r.translate(this.position.x+this.width/2,this.position.y+this.height/2),r.rotate(this.rotation),r.drawImage(li,-this.width/2,-this.height/2,this.width,this.height),r.restore()}update(){this.draw(),this.position.x+=this.velocity.velocityX,this.position.y+=this.velocity.velocityY,this.rotation-=.1}}const Mi="/chronicles-adventure/images/enemyShooter.png";let J=new Image;J.src=Mi;class Bi{constructor({x:t,y:o}){h(this,"position");h(this,"velocity");h(this,"width");h(this,"height");h(this,"image");h(this,"frame");h(this,"frameInterval");h(this,"frameTimer");h(this,"currentSprite");h(this,"currentCroppWidth");h(this,"currentCropHeight");h(this,"cropWidth");h(this,"cropHeight");h(this,"throwInterval");h(this,"throwTimer");this.position={x:t,y:o},this.velocity={x:1,y:1},this.width=50,this.height=70,this.image=J,this.frame=0,this.frameInterval=5,this.frameTimer=0,this.currentSprite=J,this.currentCroppWidth=66,this.currentCropHeight=0,this.cropWidth=160,this.cropHeight=177,this.throwInterval=40,this.throwTimer=0}draw(){r.drawImage(this.currentSprite,this.currentCroppWidth,this.currentCropHeight,this.cropWidth,this.cropHeight,this.position.x,this.position.y,this.width,this.height)}update(){this.draw(),this.frameTimer++,this.frameTimer>=this.frameInterval&&(this.currentCroppWidth=66+183*this.frame,this.frame++,this.frame>6&&(this.frame=0),this.frameTimer=0),this.position.x-=this.velocity.x,this.position.y+=this.velocity.y,this.position.y+this.height+this.velocity.y<s.height&&(this.velocity.y+=Q),this.throwTimer++,this.throwTimer>=this.throwInterval&&(H.push(new Ri({x:this.position.x,y:this.position.y},{velocityX:-2,velocityY:0},100,100)),this.throwTimer=0)}getPosition(){return this.position}}const Gi="/chronicles-adventure/images/fire.png";let $=new Image;$.src=Gi;class g{constructor({x:t,y:o}){h(this,"position");h(this,"velocity");h(this,"width");h(this,"height");h(this,"image");h(this,"frame");h(this,"frameInterval");h(this,"frameTimer");h(this,"currentSprite");h(this,"currentCroppWidth");h(this,"currentCropHeight");h(this,"cropWidth");h(this,"cropHeight");this.position={x:t,y:o},this.velocity={x:1,y:1},this.width=150,this.height=250,this.image=$,this.frame=0,this.frameInterval=10,this.frameTimer=0,this.currentSprite=$,this.currentCroppWidth=32,this.currentCropHeight=0,this.cropWidth=136,this.cropHeight=223,this.width=90,this.height=130}draw(){r.drawImage(this.currentSprite,this.currentCroppWidth,this.currentCropHeight,this.cropWidth,this.cropHeight,this.position.x,this.position.y,this.width,this.height)}update(){this.draw(),this.frameTimer++,this.frameTimer>=this.frameInterval&&(this.currentCroppWidth=32+136*this.frame,this.frame++,this.frame>6&&(this.frame=0),this.frameTimer=0)}getPosition(){return this.position}}function si(i,t){return i.position.y+i.height<=t.position.y&&i.position.y+i.height+i.velocity.y>=t.position.y&&i.position.x+i.width>=t.position.x&&i.position.x<=t.position.x+t.width}function oi(i,t){return i.position.y+i.height<=t.position.y&&i.position.y+i.height+i.velocity.y>=t.position.y&&i.position.x+i.width>=t.position.x&&i.position.x<=t.position.x+t.width}function Ni(i,t){return i.position.y+i.height<=t.position.y&&i.position.y+i.height+i.velocity.y>=t.position.y&&i.position.x+i.width>=t.position.x&&i.position.x<=t.position.x+t.width}function Ui(i,t){return i.position.x<t.position.x+t.width/2&&i.position.x+i.width/2>t.position.x&&i.position.y<t.position.y+t.height&&i.position.y+i.height>t.position.y}function qi(i,t){return i.position.x<t.position.x+t.width/2&&i.position.x+i.width/2>t.position.x&&i.position.y<t.position.y+t.height&&i.position.y+i.height>t.position.y}function zi(i,t){return i.position.x<t.position.x+t.width/2&&i.position.x+i.width/2>t.position.x&&i.position.y<t.position.y+t.height&&i.position.y+i.height>t.position.y}function Ji(i,t){return i.position.x<t.position.x+t.width/2&&i.position.x+i.width/2>t.position.x&&i.position.y<t.position.y+t.height&&i.position.y+i.height>t.position.y}function $i(i,t){return i.position.x<t.position.x+t.width/2&&i.position.x+i.width/2>t.position.x&&i.position.y<t.position.y+t.height&&i.position.y+i.height>t.position.y}function Vi(i,t){return i.position.x<t.position.x+t.width/2&&i.position.x+i.width/2>t.position.x&&i.position.y<t.position.y+t.height&&i.position.y+i.height>t.position.y}function Ki(i,t){return i.position.x<t.position.x+t.width/2&&i.position.x+i.width/2>t.position.x&&i.position.y<t.position.y+t.height/2&&i.position.y+i.height/2>t.position.y}function Qi(i,t){return i.position.x<t.position.x+t.width/2&&i.position.x+i.width/2>t.position.x&&i.position.y<t.position.y+t.height/2&&i.position.y+i.height/2>t.position.y}function Zi(i,t){return i.position.x<t.position.x+t.width/2&&i.position.x+i.width/2>t.position.x&&i.position.y<t.position.y+t.height/2&&i.position.y+i.height/2>t.position.y}const _i="/chronicles-adventure/images/explosion.png";let gi=new Image;gi.src=_i;class it{constructor(t){h(this,"position");h(this,"width");h(this,"height");h(this,"frame");h(this,"currentCroppWidth");h(this,"currentCropHeight");h(this,"cropWidth");h(this,"cropHeight");h(this,"isFinished");this.position=t,this.frame=0,this.currentCroppWidth=0,this.currentCropHeight=0,this.cropWidth=192,this.cropHeight=159,this.width=100,this.height=100,this.isFinished=!1}draw(){r.beginPath(),r.drawImage(gi,this.currentCroppWidth,this.currentCropHeight,this.cropWidth,this.cropHeight,this.position.x,this.position.y,this.width,this.height),r.closePath()}update(){this.frame++,this.frame<8?this.currentCroppWidth=195*this.frame:this.isFinished=!0,this.draw()}getPosition(){return this.position}}const tt="/chronicles-adventure/images/droneBullet.png",ui=new Image;ui.src=tt;class et{constructor(t,o,p,a){h(this,"position");h(this,"velocity");h(this,"width");h(this,"height");this.position=t,this.velocity=o,this.width=p,this.height=a}draw(){r.drawImage(ui,this.position.x,this.position.y,this.width,this.height)}update(){this.draw(),this.position.x+=this.velocity.velocityX,this.position.y+=this.velocity.velocityY}}const ht="/chronicles-adventure/images/drone.png",st="/chronicles-adventure/sounds/droneBullet.mp3",fi=new Image;fi.src=ht;const ni=new Audio(st);class ot{constructor(t,o,p,a){h(this,"position");h(this,"velocity");h(this,"width");h(this,"height");h(this,"offsetX");h(this,"offsetY");h(this,"bullets");h(this,"lastShootTime");h(this,"shootInterval");h(this,"frame");h(this,"frameInterval");h(this,"frameTimer");h(this,"currentCroppWidth");h(this,"currentCropHeight");h(this,"cropWidth");h(this,"cropHeight");this.position=t,this.velocity=o,this.width=p,this.height=a,this.offsetX=0,this.offsetY=-100,this.bullets=[],this.lastShootTime=0,this.shootInterval=300,this.frame=0,this.frameInterval=10,this.frameTimer=0,this.currentCroppWidth=0,this.currentCropHeight=0,this.cropWidth=143,this.cropHeight=79}draw(){r.drawImage(fi,this.currentCroppWidth,this.currentCropHeight,this.cropWidth,this.cropHeight,this.position.x,this.position.y,this.width,this.height)}update(){this.position.x=c.position.x+this.offsetX,this.position.y=c.position.y+this.offsetY,this.draw(),this.frameTimer++,this.frameTimer>=this.frameInterval&&(this.currentCroppWidth=143*this.frame,this.frame++,this.frame>10&&(this.frame=0),this.frameTimer=0);const t=Date.now();t-this.lastShootTime>=this.shootInterval&&(this.shoot(),this.lastShootTime=t),this.bullets.forEach((o,p)=>{o.update(),ni.play(),ni.volume=.3,m.forEach((a,l)=>{qi(o,a)&&(new Audio(j).play(),m.splice(l,1),this.bullets.splice(p,1))})}),this.bullets.forEach((o,p)=>{o.update(),E.forEach((a,l)=>{Ji(o,a)&&(new Audio(j).play(),E.splice(l,1),this.bullets.splice(p,1))})})}shoot(){let a;c.currentSprite===c.sprites.run.right||c.currentSprite===c.sprites.shootRight.right?a={velocityX:-20,velocityY:7}:a={velocityX:20,velocityY:7};const l={x:this.position.x+this.width*1/8,y:this.position.y+this.height/2};this.bullets.push(new et(l,a,50,50))}}const Z=new Image;Z.src=Wi;console.log(Z);const s=document.querySelector("canvas"),r=s.getContext("2d");s.width=window.innerWidth;s.height=window.innerHeight;const e=new Image;e.src=Ii;const nt=new Image;nt.src=Ei;const f=new Image;f.src=Ci;const wi=new Audio(Ti);wi.volume=.4;const _=new Audio(Hi);_.volume=.4;const b=new Audio(bi);b.volume=.9;_.loop=!0;let c,m=[],E=[],W=[],H=[],v=[],D=[],I=[],Y=[],yi;const w={d:{pressed:!1},a:{pressed:!1},shoot:{pressed:!1},jump:{pressed:!1}};let T=0,V=!1,ri=!1,R=5,P=!1,L=!1,mi=!1,K=!0,B=0,G=!1,ci=!1,N=!1,X=window.location.pathname.includes("levelEditor.html"),C="platform",S=null;function xi(){if(R<=0){P=!0;return}c=new Yi,yi=new ot({x:c.position.x,y:c.position.y-100},{velocityX:0,velocityY:0},50,50),v=[new d({x:0,y:s.height-e.height,image:e}),new d({x:e.width,y:s.height-e.height,image:e}),new d({x:e.width*2+n,y:s.height-e.height,image:e}),new d({x:e.width*3+n*2,y:s.height-e.height*2,image:e}),new d({x:e.width*4+n*3,y:s.height-e.height*3,image:e}),new d({x:e.width*5+n*4,y:s.height-e.height*4,image:e}),new d({x:e.width*6+n*5+n,y:s.height-e.height*3,image:e}),new d({x:e.width*7+n*6+n*2,y:s.height-e.height*3,image:e}),new d({x:e.width*8+n*7+n*3,y:s.height-e.height*2,image:e}),new d({x:e.width*9+n*8+n*4,y:s.height-e.height,image:e}),new d({x:e.width*10+n*9+n*4,y:s.height-e.height*2,image:e}),new d({x:e.width*11+n*10+n*4,y:s.height-e.height,image:e}),new d({x:e.width*12+n*11+n*4,y:s.height-e.height,image:e}),new d({x:e.width*13+n*12+n*3,y:s.height-e.height,image:e}),new d({x:e.width*14+n*13+n*3,y:s.height-e.height*2,image:e}),new d({x:e.width*15+n*14+n*3,y:s.height-e.height*3,image:e}),new d({x:e.width*16+n*15+n*3,y:s.height-e.height*2,image:e}),new d({x:e.width*17+n*16+n*3,y:s.height-e.height*3,image:e}),new d({x:e.width*18+n*17+n*3,y:s.height-e.height,image:e}),new d({x:e.width*19+n*18+n*4,y:s.height-e.height,image:e}),new d({x:e.width*20+n*19+n*5,y:s.height-e.height,image:e}),new d({x:e.width*21+n*20+n*6,y:s.height-e.height,image:e})],D=[new u({x:0,y:0,image:Z}),new u({x:300,y:s.height,image:f}),new u({x:300+y,y:s.height,image:f}),new u({x:300+y*2,y:s.height,image:f}),new u({x:300+y*3,y:s.height,image:f}),new u({x:300+y*5,y:s.height,image:f}),new u({x:300+y*7,y:s.height,image:f}),new u({x:300+y*9,y:s.height,image:f}),new u({x:300+y*10,y:s.height,image:f}),new u({x:300+y*12,y:s.height,image:f}),new u({x:300+y*13,y:s.height,image:f}),new u({x:300+y*14,y:s.height,image:f}),new u({x:300+y*15,y:s.height,image:f}),new u({x:300+y*16,y:s.height,image:f}),new u({x:300+y*17,y:s.height,image:f}),new u({x:300+y*18,y:s.height,image:f}),new u({x:300+y*19,y:s.height,image:f}),new u({x:300+y*20,y:s.height,image:f}),new u({x:300+y*21,y:s.height,image:f}),new u({x:300+y*22,y:s.height,image:f})],I=[new g({x:0+e.width/2,y:s.height-e.height*2}),new g({x:e.width+e.width/2,y:s.height-e.height*2}),new g({x:e.width*2+n+e.width/2,y:s.height-e.height*2}),new g({x:e.width*3+n*2+e.width/2,y:s.height-e.height*3}),new g({x:e.width*4+n*3+e.width/2,y:s.height-e.height*4}),new g({x:e.width*5+n*4+e.width/2,y:s.height-e.height*5}),new g({x:e.width*6+n*5+n+e.width/2,y:s.height-e.height*4}),new g({x:e.width*7+n*6+n*2+e.width/2,y:s.height-e.height*4}),new g({x:e.width*8+n*7+n*3+e.width/2,y:s.height-e.height*3}),new g({x:e.width*9+n*8+n*4+e.width/2,y:s.height-e.height*3}),new g({x:e.width*10+n*9+n*4+e.width/2,y:s.height-e.height*2}),new g({x:e.width*11+n*10+n*4+e.width/2,y:s.height-e.height*2}),new g({x:e.width*12+n*11+n*4+e.width/2,y:s.height-e.height*2}),new g({x:e.width*13+n*12+n*3+e.width/2,y:s.height-e.height*2}),new g({x:e.width*14+n*13+n*3+e.width/2,y:s.height-e.height*2}),new g({x:e.width*15+n*14+n*3+e.width/2,y:s.height-e.height*3}),new g({x:e.width*16+n*15+n*3+e.width/2,y:s.height-e.height*2}),new g({x:e.width*17+n*16+n*3+e.width/2,y:s.height-e.height*3})],T=0}e.onload=()=>{xi(),ii(),ri||(ri=!0,setInterval(()=>{!P&&!L&&m.push(new M({x:c.position.x-ki,y:c.position.y-ei}))},1e3),setInterval(()=>{!P&&!L&&E.push(new Bi({x:c.position.x+Ai,y:c.position.y-ei}))},1e3))};function pi(){r.fillStyle="Green",r.font="bold 70px Arial",r.fillText("Victory",r.canvas.width/2-100,r.canvas.height/2),P=!1,mi=!0}function rt(){r.fillStyle="White",r.font="bold 50px Arial",r.fillText("Game Over",r.canvas.width/2-100,r.canvas.height/2)}function ii(){if(P){rt();return}if(mi){pi();return}if(L){r.fillStyle="rgba(0, 0, 0, 0.5)",r.fillRect(0,0,s.width,s.height),r.fillStyle="white",r.font="bold 70px Arial",r.fillText("Paused",s.width/2-100,s.height/2);return}if(window.requestAnimationFrame(ii),r.fillStyle="white",r.clearRect(0,0,s.width,s.height),r.fillRect(0,0,s.width,s.height),_.play(),D.forEach(i=>{i.draw()}),I.forEach(i=>{i.update()}),v.forEach(i=>{i.draw()}),X)c.update(),ai(),v.forEach(i=>{si(c,i)&&(c.velocity.y=0)});else{if(c.update(),c.position.x>500&&!G&&(G=!0,N=!0,setTimeout(()=>{ci=!0,N=!1},5e3)),G&&ci&&yi.update(),ai(),W.forEach((i,t)=>{i.update(),m.forEach((o,p)=>{Ui(i,o)&&(new Audio(j).play(),m.splice(p,1),W.splice(t,1),B+=10)})}),W.forEach((i,t)=>{i.update(),E.forEach((o,p)=>{zi(i,o)&&(new Audio(j).play(),E.splice(p,1),W.splice(t,1),B+=10)})}),Y.forEach(i=>{i.update()}),Y=Y.filter(i=>!i.isFinished),W.forEach((i,t)=>{i.update(),H.forEach((o,p)=>{if(Vi(i,o)){new Audio(Pi).play();const l=new it({x:o.position.x,y:o.position.y});Y.push(l),H.splice(p,1),W.splice(t,1)}})}),H.forEach(i=>{i.update(),$i(i,c)&&(b.play(),console.log("you lose"),A())}),H.forEach((i,t)=>{i.update(),i.position.x+i.width<0&&H.splice(t,1)}),m.forEach(i=>{i.update(),v.forEach(t=>{oi(i,t)&&(i.velocity.y=0)})}),E.forEach(i=>{i.update(),v.forEach(t=>{Ni(i,t)&&(i.velocity.y=0)})}),m.forEach(i=>{Ki(c,i)&&(b.play(),console.log("you lose"),A())}),E.forEach(i=>{Qi(c,i)&&(b.play(),console.log("you lose"),A())}),I.forEach(i=>{Zi(c,i)&&(b.play(),console.log("you lose"),A())}),v.forEach(i=>{si(c,i)&&(c.velocity.y=0)}),m.forEach(i=>{i.update(),wi.play(),v.forEach(t=>{oi(i,t)&&(i.velocity.y=0)})}),T>F){pi();return}c.position.y>s.height&&(b.play(),console.log("you lose"),A()),r.fillStyle="white",r.font="20px Arial",r.fillText(`Lives: ${R}`,20,50),r.fillText(`Survival Score: ${B}`,s.width-200,50),K&&(r.fillStyle="white",r.font="14px Arial",r.fillText("Use keys to Play:",20,80),r.fillText("A: Move Left",30,100),r.fillText("D: Move Right",30,120),r.fillText("Space: Jump",30,140),r.fillText("Enter: Fire",30,160),r.fillText("P: Pause",30,180),r.fillText("Press 'G' to toggle guidance",20,220)),N&&(r.fillStyle="White",r.font="25px Arial",r.fillText("Friendly fighter drone is on the way...",r.canvas.width/2-200,r.canvas.height/2-50))}}function ai(){c.velocity.x=0,w.d.pressed&&c.position.x<500||w.d.pressed&&T===F&&c.position.x<F?c.velocity.x=x:w.a.pressed&&c.position.x>100||w.a.pressed&&T===0&&c.position.x>0?c.velocity.x=-x:(c.velocity.x=0,w.d.pressed&&T<F?(T+=x,v.forEach(i=>{i.position.x-=x}),D.forEach(i=>{i.position.x-=ti}),m.forEach(i=>{i.position.x-=x}),E.forEach(i=>{i.position.x-=x}),H.forEach(i=>{i.position.x-=x}),I.forEach(i=>{i.position.x-=x})):w.a.pressed&&T>0&&(T-=x,v.forEach(i=>{i.position.x+=x}),D.forEach(i=>{i.position.x+=ti}),m.forEach(i=>{i.position.x+=x}),E.forEach(i=>{i.position.x+=x}),H.forEach(i=>{i.position.x+=x}),I.forEach(i=>{i.position.x+=x})))}function A(){R-=1,R>0?xi():P=!0}window.addEventListener("keydown",i=>{switch(i.key){case"a":case"A":{w.a.pressed=!0,c.currentSprite=c.sprites.runLeft.left;break}case"d":case"D":{w.d.pressed=!0,c.currentSprite=c.sprites.run.right;break}case" ":{if(w.jump.pressed=!0,c.velocity.y!=0)break;c.velocity.y=-14,console.log(i.key);break}case"Enter":{if(!V){w.shoot.pressed=!0,V=!0;const t=new Audio(Li);t.volume=.2,t.play(),c.currentSprite===c.sprites.runLeft.left?W.push(new hi({x:c.position.x-c.width,y:c.position.y},{velocityX:-10,velocityY:0},100,100)):c.currentSprite===c.sprites.run.right&&W.push(new hi({x:c.position.x+c.width,y:c.position.y},{velocityX:10,velocityY:0},100,100))}break}case"p":case"P":{L=!L,L||ii();break}case"g":case"G":{K=!K;break}}});window.addEventListener("keyup",i=>{switch(i.key){case"a":{w.a.pressed=!1,c.currentCroppWidth=290,c.currentCropHeight=65;break}case"d":{w.d.pressed=!1,c.currentCroppWidth=290,c.currentCropHeight=65;break}case"Enter":{w.shoot.pressed=!1,V=!1;break}}});X&&(document.getElementById("selectPlatform").addEventListener("click",()=>{C="platform",U()}),document.getElementById("selectEnemy").addEventListener("click",()=>{C="enemy",U()}),document.getElementById("selectFire").addEventListener("click",()=>{C="fire",U()}),document.getElementById("saveLevel").addEventListener("click",at),document.getElementById("loadLevel").addEventListener("click",()=>{document.getElementById("fileInput").click()}),document.getElementById("fileInput").addEventListener("change",dt),s.addEventListener("mousedown",i=>{if(X){const t=i.offsetX,o=i.offsetY;S=pt(t,o),S||ct(t,o)}}),s.addEventListener("mousemove",i=>{if(X&&S){const t=i.offsetX,o=i.offsetY;S.position.x=t,S.position.y=o}}),s.addEventListener("mouseup",()=>{X&&(S=null)}));function U(){const i=s.width/2,t=s.height/2;C==="platform"?(S=new d({x:i,y:t,image:e}),v.push(S)):C==="enemy"?(S=new M({x:i,y:t}),m.push(S)):C==="fire"&&(S=new g({x:i,y:t}),I.push(S))}function ct(i,t){C==="platform"?v.push(new d({x:i,y:t,image:e})):C==="enemy"?m.push(new M({x:i,y:t})):C==="fire"&&I.push(new g({x:i,y:t}))}function pt(i,t){return v.find(o=>i>=o.position.x&&i<=o.position.x+o.width&&t>=o.position.y&&t<=o.position.y+o.height)||m.find(o=>i>=o.position.x&&i<=o.position.x+o.width&&t>=o.position.y&&t<=o.position.y+o.height)||I.find(o=>i>=o.position.x&&i<=o.position.x+o.width&&t>=o.position.y&&t<=o.position.y+o.height)}function at(){const i={platforms:v.map(p=>({x:p.position.x,y:p.position.y})),enemies:m.map(p=>({x:p.position.x,y:p.position.y})),fires:I.map(p=>({x:p.position.x,y:p.position.y}))},t="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(i)),o=document.createElement("a");o.setAttribute("href",t),o.setAttribute("download","level.json"),document.body.appendChild(o),o.click(),o.remove()}function dt(i){const t=i.target;if(t.files){const o=t.files[0],p=new FileReader;p.onload=a=>{const l=JSON.parse(a.target.result);lt(l)},p.readAsText(o)}}function lt(i){v=i.platforms.map(t=>new d({x:t.x,y:t.y,image:e})),m=i.enemies.map(t=>new M({x:t.x,y:t.y})),I=i.fires.map(t=>new g({x:t.x,y:t.y}))}
