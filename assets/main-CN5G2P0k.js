var vi=Object.defineProperty;var Si=(i,t,o)=>t in i?vi(i,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[t]=o;var e=(i,t,o)=>Si(i,typeof t!="symbol"?t+"":t,o);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const p of document.querySelectorAll('link[rel="modulepreload"]'))c(p);new MutationObserver(p=>{for(const l of p)if(l.type==="childList")for(const A of l.addedNodes)A.tagName==="LINK"&&A.rel==="modulepreload"&&c(A)}).observe(document,{childList:!0,subtree:!0});function o(p){const l={};return p.integrity&&(l.integrity=p.integrity),p.referrerPolicy&&(l.referrerPolicy=p.referrerPolicy),p.crossOrigin==="use-credentials"?l.credentials="include":p.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function c(p){if(p.ep)return;p.ep=!0;const l=o(p);fetch(p.href,l)}})();const Ei="/chronicles-adventure/images/platform.png",Ii="/chronicles-adventure/images/background.png",Ci="/chronicles-adventure/images/tree.png",Wi="/chronicles-adventure/sounds/zombieSound.mp3",Ti="/chronicles-adventure/sounds/backgroundMusic.mp3",Hi="/chronicles-adventure/sounds/soldierScream.mp3",j="/chronicles-adventure/sounds/deathSound.mp3",bi="/chronicles-adventure/sounds/gunfire.mp3",Li="/chronicles-adventure/sounds/explosion.mp3";class d{constructor({x:t,y:o,image:c}){e(this,"position");e(this,"image");e(this,"width");e(this,"height");this.position={x:t,y:o},this.image=c,this.width=c.width,this.height=c.height}draw(){r.drawImage(this.image,this.position.x,this.position.y,this.width,this.height)}}const Q=.5,h=150,y=500,x=5.5,ii=1,F=14e3,Pi=300,Ai=400,ti=50,ki="/chronicles-adventure/images/sprite.png",Oi="/chronicles-adventure/images/spriteFlip.png";let O=new Image;O.src=ki;let q=new Image;q.src=Oi;class Xi{constructor(){e(this,"position");e(this,"velocity");e(this,"width");e(this,"height");e(this,"image");e(this,"frame");e(this,"frameInterval");e(this,"frameTimer");e(this,"sprites");e(this,"currentSprite");e(this,"currentCroppWidth");e(this,"currentCropHeight");e(this,"cropWidth");e(this,"cropHeight");this.position={x:100,y:100},this.velocity={x:0,y:1},this.width=50,this.height=70,this.image=O,this.frame=0,this.frameInterval=2,this.frameTimer=0,this.sprites={stand:{right:O},run:{right:O},runLeft:{left:q},shootRight:{right:O},shootLeft:{left:q}},this.currentSprite=this.sprites.run.right,this.currentCroppWidth=290,this.currentCropHeight=65,this.cropWidth=87,this.cropHeight=130}draw(){r.drawImage(this.currentSprite,this.currentCroppWidth,this.currentCropHeight,this.cropWidth,this.cropHeight,this.position.x,this.position.y,this.width,this.height)}update(){this.frameTimer++,w.d.pressed&&this.currentSprite===this.sprites.run.right?(this.frameTimer>=this.frameInterval&&(this.currentCroppWidth=260+192*this.frame,this.frame++,this.frame>7&&(this.frame=0),this.frameTimer=0),this.currentCropHeight=531):w.a.pressed&&this.currentSprite===this.sprites.runLeft.left?(this.frameTimer>=this.frameInterval&&(this.currentCroppWidth=110+193*this.frame,this.frame++,this.frame>7&&(this.frame=0),this.frameTimer=0),this.currentCropHeight=531):w.shoot.pressed&&this.currentSprite===this.sprites.shootRight.right?(this.currentCroppWidth=668,this.currentCropHeight=732,this.cropWidth=110):w.shoot.pressed&&this.currentSprite===this.sprites.shootLeft.left?(this.currentCroppWidth=996,this.currentCropHeight=732,this.cropWidth=110):w.shoot.pressed===!1&&this.currentSprite===this.sprites.shootRight.right?this.currentCroppWidth=260:w.shoot.pressed===!1&&this.currentSprite===this.sprites.shootLeft.left&&(this.currentCroppWidth=258,this.currentCropHeight=64),this.draw(),this.position.x+=this.velocity.x,this.position.y+=this.velocity.y,this.position.y+this.height+this.velocity.y<a.height&&(this.velocity.y+=Q)}getPosition(){return this.position}}class f{constructor({x:t,y:o,image:c}){e(this,"position");e(this,"image");e(this,"width");e(this,"height");this.position={x:t,y:o},this.image=c,this.width=c.width,this.height=c.height}draw(){r.drawImage(this.image,this.position.x,this.position.y,this.width,this.height)}}const Yi="/chronicles-adventure/images/bullet.png",ai=new Image;ai.src=Yi;class ei{constructor(t,o,c,p){e(this,"position");e(this,"velocity");e(this,"width");e(this,"height");this.position=t,this.velocity=o,this.width=c,this.height=p}draw(){r.beginPath(),r.drawImage(ai,this.position.x,this.position.y-n.height*2/8,this.width,this.height),r.closePath()}update(){this.draw(),this.position.x+=this.velocity.velocityX,this.position.y+=this.velocity.velocityY}}const Fi="/chronicles-adventure/images/enemy.png";let z=new Image;z.src=Fi;class M{constructor({x:t,y:o}){e(this,"position");e(this,"velocity");e(this,"width");e(this,"height");e(this,"image");e(this,"frame");e(this,"frameInterval");e(this,"frameTimer");e(this,"currentSprite");e(this,"currentCroppWidth");e(this,"currentCropHeight");e(this,"cropWidth");e(this,"cropHeight");this.position={x:t,y:o},this.velocity={x:1,y:1},this.width=50,this.height=70,this.image=z,this.frame=0,this.frameInterval=10,this.frameTimer=0,this.currentSprite=z,this.currentCroppWidth=87,this.currentCropHeight=0,this.cropWidth=99,this.cropHeight=131}draw(){r.drawImage(this.currentSprite,this.currentCroppWidth,this.currentCropHeight,this.cropWidth,this.cropHeight,this.position.x,this.position.y,this.width,this.height)}update(){this.draw(),this.frameTimer++,this.frameTimer>=this.frameInterval&&(this.currentCroppWidth=105+147*this.frame,this.frame++,this.frame>10&&(this.frame=0),this.frameTimer=0),this.position.x+=this.velocity.x,this.position.y+=this.velocity.y,this.position.y+this.height+this.velocity.y<a.height&&(this.velocity.y+=Q)}getPosition(){return this.position}}const ji="/chronicles-adventure/images/stone.png";let di=new Image;di.src=ji;class Di{constructor(t,o,c,p){e(this,"position");e(this,"velocity");e(this,"width");e(this,"height");e(this,"rotation");this.position=t,this.velocity=o,this.width=c,this.height=p,this.rotation=0}draw(){r.save(),r.translate(this.position.x+this.width/2,this.position.y+this.height/2),r.rotate(this.rotation),r.drawImage(di,-this.width/2,-this.height/2,this.width,this.height),r.restore()}update(){this.draw(),this.position.x+=this.velocity.velocityX,this.position.y+=this.velocity.velocityY,this.rotation-=.1}}const Ri="/chronicles-adventure/images/enemyShooter.png";let J=new Image;J.src=Ri;class Mi{constructor({x:t,y:o}){e(this,"position");e(this,"velocity");e(this,"width");e(this,"height");e(this,"image");e(this,"frame");e(this,"frameInterval");e(this,"frameTimer");e(this,"currentSprite");e(this,"currentCroppWidth");e(this,"currentCropHeight");e(this,"cropWidth");e(this,"cropHeight");e(this,"throwInterval");e(this,"throwTimer");this.position={x:t,y:o},this.velocity={x:1,y:1},this.width=50,this.height=70,this.image=J,this.frame=0,this.frameInterval=5,this.frameTimer=0,this.currentSprite=J,this.currentCroppWidth=66,this.currentCropHeight=0,this.cropWidth=160,this.cropHeight=177,this.throwInterval=40,this.throwTimer=0}draw(){r.drawImage(this.currentSprite,this.currentCroppWidth,this.currentCropHeight,this.cropWidth,this.cropHeight,this.position.x,this.position.y,this.width,this.height)}update(){this.draw(),this.frameTimer++,this.frameTimer>=this.frameInterval&&(this.currentCroppWidth=66+183*this.frame,this.frame++,this.frame>6&&(this.frame=0),this.frameTimer=0),this.position.x-=this.velocity.x,this.position.y+=this.velocity.y,this.position.y+this.height+this.velocity.y<a.height&&(this.velocity.y+=Q),this.throwTimer++,this.throwTimer>=this.throwInterval&&(H.push(new Di({x:this.position.x,y:this.position.y},{velocityX:-2,velocityY:0},100,100)),this.throwTimer=0)}getPosition(){return this.position}}const Bi="/chronicles-adventure/images/fire.png";let $=new Image;$.src=Bi;class u{constructor({x:t,y:o}){e(this,"position");e(this,"velocity");e(this,"width");e(this,"height");e(this,"image");e(this,"frame");e(this,"frameInterval");e(this,"frameTimer");e(this,"currentSprite");e(this,"currentCroppWidth");e(this,"currentCropHeight");e(this,"cropWidth");e(this,"cropHeight");this.position={x:t,y:o},this.velocity={x:1,y:1},this.width=150,this.height=250,this.image=$,this.frame=0,this.frameInterval=10,this.frameTimer=0,this.currentSprite=$,this.currentCroppWidth=32,this.currentCropHeight=0,this.cropWidth=136,this.cropHeight=223,this.width=90,this.height=130}draw(){r.drawImage(this.currentSprite,this.currentCroppWidth,this.currentCropHeight,this.cropWidth,this.cropHeight,this.position.x,this.position.y,this.width,this.height)}update(){this.draw(),this.frameTimer++,this.frameTimer>=this.frameInterval&&(this.currentCroppWidth=32+136*this.frame,this.frame++,this.frame>6&&(this.frame=0),this.frameTimer=0)}getPosition(){return this.position}}function oi(i,t){return i.position.y+i.height<=t.position.y&&i.position.y+i.height+i.velocity.y>=t.position.y&&i.position.x+i.width>=t.position.x&&i.position.x<=t.position.x+t.width}function si(i,t){return i.position.y+i.height<=t.position.y&&i.position.y+i.height+i.velocity.y>=t.position.y&&i.position.x+i.width>=t.position.x&&i.position.x<=t.position.x+t.width}function Gi(i,t){return i.position.y+i.height<=t.position.y&&i.position.y+i.height+i.velocity.y>=t.position.y&&i.position.x+i.width>=t.position.x&&i.position.x<=t.position.x+t.width}function Ni(i,t){return i.position.x<t.position.x+t.width/2&&i.position.x+i.width/2>t.position.x&&i.position.y<t.position.y+t.height&&i.position.y+i.height>t.position.y}function Ui(i,t){return i.position.x<t.position.x+t.width/2&&i.position.x+i.width/2>t.position.x&&i.position.y<t.position.y+t.height&&i.position.y+i.height>t.position.y}function qi(i,t){return i.position.x<t.position.x+t.width/2&&i.position.x+i.width/2>t.position.x&&i.position.y<t.position.y+t.height&&i.position.y+i.height>t.position.y}function zi(i,t){return i.position.x<t.position.x+t.width/2&&i.position.x+i.width/2>t.position.x&&i.position.y<t.position.y+t.height&&i.position.y+i.height>t.position.y}function Ji(i,t){return i.position.x<t.position.x+t.width/2&&i.position.x+i.width/2>t.position.x&&i.position.y<t.position.y+t.height&&i.position.y+i.height>t.position.y}function $i(i,t){return i.position.x<t.position.x+t.width/2&&i.position.x+i.width/2>t.position.x&&i.position.y<t.position.y+t.height&&i.position.y+i.height>t.position.y}function Vi(i,t){return i.position.x<t.position.x+t.width/2&&i.position.x+i.width/2>t.position.x&&i.position.y<t.position.y+t.height/2&&i.position.y+i.height/2>t.position.y}function Ki(i,t){return i.position.x<t.position.x+t.width/2&&i.position.x+i.width/2>t.position.x&&i.position.y<t.position.y+t.height/2&&i.position.y+i.height/2>t.position.y}function Qi(i,t){return i.position.x<t.position.x+t.width/2&&i.position.x+i.width/2>t.position.x&&i.position.y<t.position.y+t.height/2&&i.position.y+i.height/2>t.position.y}const Zi="/chronicles-adventure/images/explosion.png";let li=new Image;li.src=Zi;class _i{constructor(t){e(this,"position");e(this,"width");e(this,"height");e(this,"frame");e(this,"currentCroppWidth");e(this,"currentCropHeight");e(this,"cropWidth");e(this,"cropHeight");e(this,"isFinished");this.position=t,this.frame=0,this.currentCroppWidth=0,this.currentCropHeight=0,this.cropWidth=192,this.cropHeight=159,this.width=100,this.height=100,this.isFinished=!1}draw(){r.beginPath(),r.drawImage(li,this.currentCroppWidth,this.currentCropHeight,this.cropWidth,this.cropHeight,this.position.x,this.position.y,this.width,this.height),r.closePath()}update(){this.frame++,this.frame<8?this.currentCroppWidth=195*this.frame:this.isFinished=!0,this.draw()}getPosition(){return this.position}}const it="/chronicles-adventure/images/droneBullet.png",ui=new Image;ui.src=it;class tt{constructor(t,o,c,p){e(this,"position");e(this,"velocity");e(this,"width");e(this,"height");this.position=t,this.velocity=o,this.width=c,this.height=p}draw(){r.drawImage(ui,this.position.x,this.position.y,this.width,this.height)}update(){this.draw(),this.position.x+=this.velocity.velocityX,this.position.y+=this.velocity.velocityY}}const et="/chronicles-adventure/images/drone.png",ot="/chronicles-adventure/sounds/droneBullet.mp3",fi=new Image;fi.src=et;const hi=new Audio(ot);class st{constructor(t,o,c,p){e(this,"position");e(this,"velocity");e(this,"width");e(this,"height");e(this,"offsetX");e(this,"offsetY");e(this,"bullets");e(this,"lastShootTime");e(this,"shootInterval");e(this,"frame");e(this,"frameInterval");e(this,"frameTimer");e(this,"currentCroppWidth");e(this,"currentCropHeight");e(this,"cropWidth");e(this,"cropHeight");this.position=t,this.velocity=o,this.width=c,this.height=p,this.offsetX=0,this.offsetY=-100,this.bullets=[],this.lastShootTime=0,this.shootInterval=300,this.frame=0,this.frameInterval=10,this.frameTimer=0,this.currentCroppWidth=0,this.currentCropHeight=0,this.cropWidth=143,this.cropHeight=79}draw(){r.drawImage(fi,this.currentCroppWidth,this.currentCropHeight,this.cropWidth,this.cropHeight,this.position.x,this.position.y,this.width,this.height)}update(){this.position.x=n.position.x+this.offsetX,this.position.y=n.position.y+this.offsetY,this.draw(),this.frameTimer++,this.frameTimer>=this.frameInterval&&(this.currentCroppWidth=143*this.frame,this.frame++,this.frame>10&&(this.frame=0),this.frameTimer=0);const t=Date.now();t-this.lastShootTime>=this.shootInterval&&(this.shoot(),this.lastShootTime=t),this.bullets.forEach((o,c)=>{o.update(),hi.play(),hi.volume=.3,m.forEach((p,l)=>{Ui(o,p)&&(new Audio(j).play(),m.splice(l,1),this.bullets.splice(c,1))})}),this.bullets.forEach((o,c)=>{o.update(),I.forEach((p,l)=>{zi(o,p)&&(new Audio(j).play(),I.splice(l,1),this.bullets.splice(c,1))})})}shoot(){let p;n.currentSprite===n.sprites.run.right||n.currentSprite===n.sprites.shootRight.right?p={velocityX:-20,velocityY:7}:p={velocityX:20,velocityY:7};const l={x:this.position.x+this.width*1/8,y:this.position.y+this.height/2};this.bullets.push(new tt(l,p,50,50))}}const a=document.querySelector("canvas"),r=a.getContext("2d");a.width=window.innerWidth;a.height=window.innerHeight;const s=new Image;s.src=Ei;const gi=new Image;gi.src=Ii;const g=new Image;g.src=Ci;const wi=new Audio(Wi);wi.volume=.4;const Z=new Audio(Ti);Z.volume=.4;const b=new Audio(Hi);b.volume=.9;Z.loop=!0;let n,m=[],I=[],W=[],H=[],v=[],D=[],E=[],Y=[],yi;const w={d:{pressed:!1},a:{pressed:!1},shoot:{pressed:!1},jump:{pressed:!1}};let T=0,V=!1,ni=!1,R=5,P=!1,L=!1,mi=!1,K=!0,B=0,G=!1,ri=!1,N=!1,X=window.location.pathname.includes("levelEditor.html"),C="platform",S=null;function xi(){if(R<=0){P=!0;return}n=new Xi,yi=new st({x:n.position.x,y:n.position.y-100},{velocityX:0,velocityY:0},50,50),v=[new d({x:0,y:a.height-s.height,image:s}),new d({x:s.width,y:a.height-s.height,image:s}),new d({x:s.width*2+h,y:500,image:s}),new d({x:s.width*3+h*2,y:400,image:s}),new d({x:s.width*4+h*3,y:300,image:s}),new d({x:s.width*5+h*4,y:200,image:s}),new d({x:s.width*6+h*5+h,y:300,image:s}),new d({x:s.width*7+h*6+h*2,y:300,image:s}),new d({x:s.width*8+h*7+h*3,y:400,image:s}),new d({x:s.width*9+h*8+h*4,y:500,image:s}),new d({x:s.width*10+h*9+h*4,y:400,image:s}),new d({x:s.width*11+h*10+h*4,y:500,image:s}),new d({x:s.width*12+h*11+h*4,y:500,image:s}),new d({x:s.width*13+h*12+h*3,y:500,image:s}),new d({x:s.width*14+h*13+h*3,y:400,image:s}),new d({x:s.width*15+h*14+h*3,y:300,image:s}),new d({x:s.width*16+h*15+h*3,y:400,image:s}),new d({x:s.width*17+h*16+h*3,y:300,image:s}),new d({x:s.width*18+h*17+h*3,y:500,image:s}),new d({x:s.width*19+h*18+h*4,y:500,image:s}),new d({x:s.width*20+h*19+h*5,y:500,image:s}),new d({x:s.width*21+h*20+h*6,y:500,image:s})],D=[new f({x:0,y:0,image:gi}),new f({x:300,y:100,image:g}),new f({x:300+y,y:100,image:g}),new f({x:300+y*2,y:100,image:g}),new f({x:300+y*3,y:100,image:g}),new f({x:300+y*5,y:100,image:g}),new f({x:300+y*7,y:100,image:g}),new f({x:300+y*9,y:100,image:g}),new f({x:300+y*10,y:100,image:g}),new f({x:300+y*12,y:100,image:g}),new f({x:300+y*13,y:100,image:g}),new f({x:300+y*14,y:100,image:g}),new f({x:300+y*15,y:100,image:g}),new f({x:300+y*16,y:100,image:g}),new f({x:300+y*17,y:100,image:g}),new f({x:300+y*18,y:100,image:g}),new f({x:300+y*19,y:100,image:g}),new f({x:300+y*20,y:100,image:g}),new f({x:300+y*21,y:100,image:g}),new f({x:300+y*22,y:100,image:g})],E=[new u({x:s.width/2,y:400}),new u({x:s.width/2*2+h,y:400}),new u({x:s.width*2+h*2,y:400}),new u({x:s.width*3+h*3,y:300}),new u({x:s.width*4+h*4,y:200}),new u({x:s.width*5+h*5,y:100}),new u({x:s.width*6+h*6+h,y:200}),new u({x:s.width*7+h*7+h*2,y:200}),new u({x:s.width*8+h*8+h*3,y:300}),new u({x:s.width*9+h*9+h*4,y:400}),new u({x:s.width*10+h*10+h*4,y:300}),new u({x:s.width*11+h*11+h*4,y:400}),new u({x:s.width*12+h*12+h*4,y:400}),new u({x:s.width*13+h*13+h*3,y:400}),new u({x:s.width*14+h*14+h*4,y:300}),new u({x:s.width*15+h*15+h*5,y:200}),new u({x:s.width*16+h*16+h*4,y:300}),new u({x:s.width*17+h*17+h*6,y:200})],T=0}s.onload=()=>{xi(),_(),ni||(ni=!0,setInterval(()=>{!P&&!L&&m.push(new M({x:n.position.x-Pi,y:n.position.y-ti}))},1e3),setInterval(()=>{!P&&!L&&I.push(new Mi({x:n.position.x+Ai,y:n.position.y-ti}))},1e3))};function ci(){r.fillStyle="Green",r.font="bold 70px Arial",r.fillText("Victory",a.width/2-100,a.height/2),P=!1,mi=!0}function _(){if(P){ht();return}if(mi){ci();return}if(L){r.fillStyle="rgba(0, 0, 0, 0.5)",r.fillRect(0,0,a.width,a.height),r.fillStyle="white",r.font="bold 70px Arial",r.fillText("Paused",a.width/2-100,a.height/2);return}if(window.requestAnimationFrame(_),r.fillStyle="white",r.clearRect(0,0,a.width,a.height),r.fillRect(0,0,a.width,a.height),Z.play(),D.forEach(i=>{i.draw()}),E.forEach(i=>{i.update()}),v.forEach(i=>{i.draw()}),X)n.update(),pi(),v.forEach(i=>{oi(n,i)&&(n.velocity.y=0)});else{if(n.update(),n.position.x>500&&!G&&(G=!0,N=!0,setTimeout(()=>{ri=!0,N=!1},5e3)),G&&ri&&yi.update(),pi(),W.forEach((i,t)=>{i.update(),m.forEach((o,c)=>{Ni(i,o)&&(new Audio(j).play(),m.splice(c,1),W.splice(t,1),B+=10)})}),W.forEach((i,t)=>{i.update(),I.forEach((o,c)=>{qi(i,o)&&(new Audio(j).play(),I.splice(c,1),W.splice(t,1),B+=10)})}),Y.forEach(i=>{i.update()}),Y=Y.filter(i=>!i.isFinished),W.forEach((i,t)=>{i.update(),H.forEach((o,c)=>{if($i(i,o)){new Audio(Li).play();const l=new _i({x:o.position.x,y:o.position.y});Y.push(l),H.splice(c,1),W.splice(t,1)}})}),H.forEach(i=>{i.update(),Ji(i,n)&&(b.play(),console.log("you lose"),k())}),H.forEach((i,t)=>{i.update(),i.position.x+i.width<0&&H.splice(t,1)}),m.forEach(i=>{i.update(),v.forEach(t=>{si(i,t)&&(i.velocity.y=0)})}),I.forEach(i=>{i.update(),v.forEach(t=>{Gi(i,t)&&(i.velocity.y=0)})}),m.forEach(i=>{Vi(n,i)&&(b.play(),console.log("you lose"),k())}),I.forEach(i=>{Ki(n,i)&&(b.play(),console.log("you lose"),k())}),E.forEach(i=>{Qi(n,i)&&(b.play(),console.log("you lose"),k())}),v.forEach(i=>{oi(n,i)&&(n.velocity.y=0)}),m.forEach(i=>{i.update(),wi.play(),v.forEach(t=>{si(i,t)&&(i.velocity.y=0)})}),T>F){ci();return}n.position.y>a.height&&(b.play(),console.log("you lose"),k()),r.fillStyle="white",r.font="20px Arial",r.fillText(`Lives: ${R}`,20,50),r.fillText(`Survival Score: ${B}`,a.width-200,50),K&&(r.fillStyle="white",r.font="14px Arial",r.fillText("Use keys to Play:",20,80),r.fillText("A: Move Left",30,100),r.fillText("D: Move Right",30,120),r.fillText("Space: Jump",30,140),r.fillText("Enter: Fire",30,160),r.fillText("P: Pause",30,180),r.fillText("Press 'G' to toggle guidance",20,220)),N&&(r.fillStyle="White",r.font="25px Arial",r.fillText("Friendly fighter drone is on the way...",a.width/2-200,a.height/2-50))}}function pi(){n.velocity.x=0,w.d.pressed&&n.position.x<500||w.d.pressed&&T===F&&n.position.x<F?n.velocity.x=x:w.a.pressed&&n.position.x>100||w.a.pressed&&T===0&&n.position.x>0?n.velocity.x=-x:(n.velocity.x=0,w.d.pressed&&T<F?(T+=x,v.forEach(i=>{i.position.x-=x}),D.forEach(i=>{i.position.x-=ii}),m.forEach(i=>{i.position.x-=x}),I.forEach(i=>{i.position.x-=x}),H.forEach(i=>{i.position.x-=x}),E.forEach(i=>{i.position.x-=x})):w.a.pressed&&T>0&&(T-=x,v.forEach(i=>{i.position.x+=x}),D.forEach(i=>{i.position.x+=ii}),m.forEach(i=>{i.position.x+=x}),I.forEach(i=>{i.position.x+=x}),H.forEach(i=>{i.position.x+=x}),E.forEach(i=>{i.position.x+=x})))}function k(){R-=1,R>0?xi():P=!0}function ht(){r.fillStyle="White",r.font="bold 50px Arial",r.fillText("Game Over",a.width/2-100,a.height/2)}window.addEventListener("keydown",i=>{switch(i.key){case"a":case"A":{w.a.pressed=!0,n.currentSprite=n.sprites.runLeft.left;break}case"d":case"D":{w.d.pressed=!0,n.currentSprite=n.sprites.run.right;break}case" ":{if(w.jump.pressed=!0,n.velocity.y!=0)break;n.velocity.y=-12,console.log(i.key);break}case"Enter":{if(!V){w.shoot.pressed=!0,V=!0;const t=new Audio(bi);t.volume=.2,t.play(),n.currentSprite===n.sprites.runLeft.left?W.push(new ei({x:n.position.x-n.width,y:n.position.y},{velocityX:-10,velocityY:0},100,100)):n.currentSprite===n.sprites.run.right&&W.push(new ei({x:n.position.x+n.width,y:n.position.y},{velocityX:10,velocityY:0},100,100))}break}case"p":case"P":{L=!L,L||_();break}case"g":case"G":{K=!K;break}}});window.addEventListener("keyup",i=>{switch(i.key){case"a":{w.a.pressed=!1,n.currentCroppWidth=290,n.currentCropHeight=65;break}case"d":{w.d.pressed=!1,n.currentCroppWidth=290,n.currentCropHeight=65;break}case"Enter":{w.shoot.pressed=!1,V=!1;break}}});X&&(document.getElementById("selectPlatform").addEventListener("click",()=>{C="platform",U()}),document.getElementById("selectEnemy").addEventListener("click",()=>{C="enemy",U()}),document.getElementById("selectFire").addEventListener("click",()=>{C="fire",U()}),document.getElementById("saveLevel").addEventListener("click",ct),document.getElementById("loadLevel").addEventListener("click",()=>{document.getElementById("fileInput").click()}),document.getElementById("fileInput").addEventListener("change",pt),a.addEventListener("mousedown",i=>{if(X){const t=i.offsetX,o=i.offsetY;S=rt(t,o),S||nt(t,o)}}),a.addEventListener("mousemove",i=>{if(X&&S){const t=i.offsetX,o=i.offsetY;S.position.x=t,S.position.y=o}}),a.addEventListener("mouseup",()=>{X&&(S=null)}));function U(){const i=a.width/2,t=a.height/2;C==="platform"?(S=new d({x:i,y:t,image:s}),v.push(S)):C==="enemy"?(S=new M({x:i,y:t}),m.push(S)):C==="fire"&&(S=new u({x:i,y:t}),E.push(S))}function nt(i,t){C==="platform"?v.push(new d({x:i,y:t,image:s})):C==="enemy"?m.push(new M({x:i,y:t})):C==="fire"&&E.push(new u({x:i,y:t}))}function rt(i,t){return v.find(o=>i>=o.position.x&&i<=o.position.x+o.width&&t>=o.position.y&&t<=o.position.y+o.height)||m.find(o=>i>=o.position.x&&i<=o.position.x+o.width&&t>=o.position.y&&t<=o.position.y+o.height)||E.find(o=>i>=o.position.x&&i<=o.position.x+o.width&&t>=o.position.y&&t<=o.position.y+o.height)}function ct(){const i={platforms:v.map(c=>({x:c.position.x,y:c.position.y})),enemies:m.map(c=>({x:c.position.x,y:c.position.y})),fires:E.map(c=>({x:c.position.x,y:c.position.y}))},t="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(i)),o=document.createElement("a");o.setAttribute("href",t),o.setAttribute("download","level.json"),document.body.appendChild(o),o.click(),o.remove()}function pt(i){const t=i.target;if(t.files){const o=t.files[0],c=new FileReader;c.onload=p=>{const l=JSON.parse(p.target.result);at(l)},c.readAsText(o)}}function at(i){v=i.platforms.map(t=>new d({x:t.x,y:t.y,image:s})),m=i.enemies.map(t=>new M({x:t.x,y:t.y})),E=i.fires.map(t=>new u({x:t.x,y:t.y}))}
