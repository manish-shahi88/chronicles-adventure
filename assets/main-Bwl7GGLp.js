var Ii=Object.defineProperty;var Si=(i,t,o)=>t in i?Ii(i,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[t]=o;var h=(i,t,o)=>Si(i,typeof t!="symbol"?t+"":t,o);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))p(d);new MutationObserver(d=>{for(const g of d)if(g.type==="childList")for(const k of g.addedNodes)k.tagName==="LINK"&&k.rel==="modulepreload"&&p(k)}).observe(document,{childList:!0,subtree:!0});function o(d){const g={};return d.integrity&&(g.integrity=d.integrity),d.referrerPolicy&&(g.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?g.credentials="include":d.crossOrigin==="anonymous"?g.credentials="omit":g.credentials="same-origin",g}function p(d){if(d.ep)return;d.ep=!0;const g=o(d);fetch(d.href,g)}})();const Ei="/chronicles-adventure/images/platform.png",Ci="/chronicles-adventure/images/background.png",Wi="/chronicles-adventure/images/tree.png",Ti="/chronicles-adventure/images/background%204.png",Hi="/chronicles-adventure/sounds/zombieSound.mp3",bi="/chronicles-adventure/sounds/backgroundMusic.mp3",Li="/chronicles-adventure/sounds/soldierScream.mp3",j="/chronicles-adventure/sounds/deathSound.mp3",Pi="/chronicles-adventure/sounds/gunfire.mp3",ki="/chronicles-adventure/sounds/explosion.mp3";class l{constructor({x:t,y:o,image:p}){h(this,"position");h(this,"image");h(this,"width");h(this,"height");this.position={x:t,y:o},this.image=p,this.width=s.width/2,this.height=p.height}draw(){r.drawImage(this.image,this.position.x,this.position.y,this.width,this.height)}}const Q=.5,n=150,y=500,x=6,ii=1,F=14e3,Ai=300,Oi=400,ti=50,Xi="/chronicles-adventure/images/sprite.png",Yi="/chronicles-adventure/images/spriteFlip.png";let O=new Image;O.src=Xi;let q=new Image;q.src=Yi;class Fi{constructor(){h(this,"position");h(this,"velocity");h(this,"width");h(this,"height");h(this,"image");h(this,"frame");h(this,"frameInterval");h(this,"frameTimer");h(this,"sprites");h(this,"currentSprite");h(this,"currentCroppWidth");h(this,"currentCropHeight");h(this,"cropWidth");h(this,"cropHeight");this.position={x:100,y:100},this.velocity={x:0,y:1},this.width=50,this.height=70,this.image=O,this.frame=0,this.frameInterval=2,this.frameTimer=0,this.sprites={stand:{right:O},run:{right:O},runLeft:{left:q},shootRight:{right:O},shootLeft:{left:q}},this.currentSprite=this.sprites.run.right,this.currentCroppWidth=290,this.currentCropHeight=65,this.cropWidth=87,this.cropHeight=130}draw(){r.drawImage(this.currentSprite,this.currentCroppWidth,this.currentCropHeight,this.cropWidth,this.cropHeight,this.position.x,this.position.y,this.width,this.height)}update(){this.frameTimer++,w.d.pressed&&this.currentSprite===this.sprites.run.right?(this.frameTimer>=this.frameInterval&&(this.currentCroppWidth=260+192*this.frame,this.frame++,this.frame>7&&(this.frame=0),this.frameTimer=0),this.currentCropHeight=531):w.a.pressed&&this.currentSprite===this.sprites.runLeft.left?(this.frameTimer>=this.frameInterval&&(this.currentCroppWidth=110+193*this.frame,this.frame++,this.frame>7&&(this.frame=0),this.frameTimer=0),this.currentCropHeight=531):w.shoot.pressed&&this.currentSprite===this.sprites.shootRight.right?(this.currentCroppWidth=668,this.currentCropHeight=732,this.cropWidth=110):w.shoot.pressed&&this.currentSprite===this.sprites.shootLeft.left?(this.currentCroppWidth=996,this.currentCropHeight=732,this.cropWidth=110):w.shoot.pressed===!1&&this.currentSprite===this.sprites.shootRight.right?this.currentCroppWidth=260:w.shoot.pressed===!1&&this.currentSprite===this.sprites.shootLeft.left&&(this.currentCroppWidth=258,this.currentCropHeight=64),this.draw(),this.position.x+=this.velocity.x,this.position.y+=this.velocity.y,this.position.y+this.height+this.velocity.y<s.height&&(this.velocity.y+=Q)}getPosition(){return this.position}}class f{constructor({x:t,y:o,image:p}){h(this,"position");h(this,"image");h(this,"width");h(this,"height");this.position={x:t,y:o},this.image=p,this.width=p.width,this.height=p.height}draw(){r.drawImage(this.image,this.position.x,this.position.y,this.width,this.height)}}const ji="/chronicles-adventure/images/bullet.png",ai=new Image;ai.src=ji;class ei{constructor(t,o,p,d){h(this,"position");h(this,"velocity");h(this,"width");h(this,"height");this.position=t,this.velocity=o,this.width=p,this.height=d}draw(){r.beginPath(),r.drawImage(ai,this.position.x,this.position.y-c.height*2/8,this.width,this.height),r.closePath()}update(){this.draw(),this.position.x+=this.velocity.velocityX,this.position.y+=this.velocity.velocityY}}const Di="/chronicles-adventure/images/enemy.png";let z=new Image;z.src=Di;class B{constructor({x:t,y:o}){h(this,"position");h(this,"velocity");h(this,"width");h(this,"height");h(this,"image");h(this,"frame");h(this,"frameInterval");h(this,"frameTimer");h(this,"currentSprite");h(this,"currentCroppWidth");h(this,"currentCropHeight");h(this,"cropWidth");h(this,"cropHeight");this.position={x:t,y:o},this.velocity={x:1,y:1},this.width=50,this.height=70,this.image=z,this.frame=0,this.frameInterval=10,this.frameTimer=0,this.currentSprite=z,this.currentCroppWidth=87,this.currentCropHeight=0,this.cropWidth=99,this.cropHeight=131}draw(){r.drawImage(this.currentSprite,this.currentCroppWidth,this.currentCropHeight,this.cropWidth,this.cropHeight,this.position.x,this.position.y,this.width,this.height)}update(){this.draw(),this.frameTimer++,this.frameTimer>=this.frameInterval&&(this.currentCroppWidth=105+147*this.frame,this.frame++,this.frame>10&&(this.frame=0),this.frameTimer=0),this.position.x+=this.velocity.x,this.position.y+=this.velocity.y,this.position.y+this.height+this.velocity.y<s.height&&(this.velocity.y+=Q)}getPosition(){return this.position}}const Ri="/chronicles-adventure/images/stone.png";let di=new Image;di.src=Ri;class Bi{constructor(t,o,p,d){h(this,"position");h(this,"velocity");h(this,"width");h(this,"height");h(this,"rotation");this.position=t,this.velocity=o,this.width=p,this.height=d,this.rotation=0}draw(){r.save(),r.translate(this.position.x+this.width/2,this.position.y+this.height/2),r.rotate(this.rotation),r.drawImage(di,-this.width/2,-this.height/2,this.width,this.height),r.restore()}update(){this.draw(),this.position.x+=this.velocity.velocityX,this.position.y+=this.velocity.velocityY,this.rotation-=.1}}const Mi="/chronicles-adventure/images/enemyShooter.png";let J=new Image;J.src=Mi;class Gi{constructor({x:t,y:o}){h(this,"position");h(this,"velocity");h(this,"width");h(this,"height");h(this,"image");h(this,"frame");h(this,"frameInterval");h(this,"frameTimer");h(this,"currentSprite");h(this,"currentCroppWidth");h(this,"currentCropHeight");h(this,"cropWidth");h(this,"cropHeight");h(this,"throwInterval");h(this,"throwTimer");this.position={x:t,y:o},this.velocity={x:1,y:1},this.width=50,this.height=70,this.image=J,this.frame=0,this.frameInterval=5,this.frameTimer=0,this.currentSprite=J,this.currentCroppWidth=66,this.currentCropHeight=0,this.cropWidth=160,this.cropHeight=177,this.throwInterval=40,this.throwTimer=0}draw(){r.drawImage(this.currentSprite,this.currentCroppWidth,this.currentCropHeight,this.cropWidth,this.cropHeight,this.position.x,this.position.y,this.width,this.height)}update(){this.draw(),this.frameTimer++,this.frameTimer>=this.frameInterval&&(this.currentCroppWidth=66+183*this.frame,this.frame++,this.frame>6&&(this.frame=0),this.frameTimer=0),this.position.x-=this.velocity.x,this.position.y+=this.velocity.y,this.position.y+this.height+this.velocity.y<s.height&&(this.velocity.y+=Q),this.throwTimer++,this.throwTimer>=this.throwInterval&&(H.push(new Bi({x:this.position.x,y:this.position.y},{velocityX:-2,velocityY:0},100,100)),this.throwTimer=0)}getPosition(){return this.position}}const Ni="/chronicles-adventure/images/fire.png";let $=new Image;$.src=Ni;class u{constructor({x:t,y:o}){h(this,"position");h(this,"velocity");h(this,"width");h(this,"height");h(this,"image");h(this,"frame");h(this,"frameInterval");h(this,"frameTimer");h(this,"currentSprite");h(this,"currentCroppWidth");h(this,"currentCropHeight");h(this,"cropWidth");h(this,"cropHeight");this.position={x:t,y:o},this.velocity={x:1,y:1},this.width=150,this.height=250,this.image=$,this.frame=0,this.frameInterval=10,this.frameTimer=0,this.currentSprite=$,this.currentCroppWidth=32,this.currentCropHeight=0,this.cropWidth=136,this.cropHeight=223,this.width=90,this.height=130}draw(){r.drawImage(this.currentSprite,this.currentCroppWidth,this.currentCropHeight,this.cropWidth,this.cropHeight,this.position.x,this.position.y,this.width,this.height)}update(){this.draw(),this.frameTimer++,this.frameTimer>=this.frameInterval&&(this.currentCroppWidth=32+136*this.frame,this.frame++,this.frame>6&&(this.frame=0),this.frameTimer=0)}getPosition(){return this.position}}function hi(i,t){return i.position.y+i.height<=t.position.y&&i.position.y+i.height+i.velocity.y>=t.position.y&&i.position.x+i.width>=t.position.x&&i.position.x<=t.position.x+t.width}function si(i,t){return i.position.y+i.height<=t.position.y&&i.position.y+i.height+i.velocity.y>=t.position.y&&i.position.x+i.width>=t.position.x&&i.position.x<=t.position.x+t.width}function Ui(i,t){return i.position.y+i.height<=t.position.y&&i.position.y+i.height+i.velocity.y>=t.position.y&&i.position.x+i.width>=t.position.x&&i.position.x<=t.position.x+t.width}function qi(i,t){return i.position.x<t.position.x+t.width/2&&i.position.x+i.width/2>t.position.x&&i.position.y<t.position.y+t.height&&i.position.y+i.height>t.position.y}function zi(i,t){return i.position.x<t.position.x+t.width/2&&i.position.x+i.width/2>t.position.x&&i.position.y<t.position.y+t.height&&i.position.y+i.height>t.position.y}function Ji(i,t){return i.position.x<t.position.x+t.width/2&&i.position.x+i.width/2>t.position.x&&i.position.y<t.position.y+t.height&&i.position.y+i.height>t.position.y}function $i(i,t){return i.position.x<t.position.x+t.width/2&&i.position.x+i.width/2>t.position.x&&i.position.y<t.position.y+t.height&&i.position.y+i.height>t.position.y}function Vi(i,t){return i.position.x<t.position.x+t.width/2&&i.position.x+i.width/2>t.position.x&&i.position.y<t.position.y+t.height&&i.position.y+i.height>t.position.y}function Ki(i,t){return i.position.x<t.position.x+t.width/2&&i.position.x+i.width/2>t.position.x&&i.position.y<t.position.y+t.height&&i.position.y+i.height>t.position.y}function Qi(i,t){return i.position.x<t.position.x+t.width/2&&i.position.x+i.width/2>t.position.x&&i.position.y<t.position.y+t.height/2&&i.position.y+i.height/2>t.position.y}function Zi(i,t){return i.position.x<t.position.x+t.width/2&&i.position.x+i.width/2>t.position.x&&i.position.y<t.position.y+t.height/2&&i.position.y+i.height/2>t.position.y}function _i(i,t){return i.position.x<t.position.x+t.width/2&&i.position.x+i.width/2>t.position.x&&i.position.y<t.position.y+t.height/2&&i.position.y+i.height/2>t.position.y}const it="/chronicles-adventure/images/explosion.png";let li=new Image;li.src=it;class tt{constructor(t){h(this,"position");h(this,"width");h(this,"height");h(this,"frame");h(this,"currentCroppWidth");h(this,"currentCropHeight");h(this,"cropWidth");h(this,"cropHeight");h(this,"isFinished");this.position=t,this.frame=0,this.currentCroppWidth=0,this.currentCropHeight=0,this.cropWidth=192,this.cropHeight=159,this.width=100,this.height=100,this.isFinished=!1}draw(){r.beginPath(),r.drawImage(li,this.currentCroppWidth,this.currentCropHeight,this.cropWidth,this.cropHeight,this.position.x,this.position.y,this.width,this.height),r.closePath()}update(){this.frame++,this.frame<8?this.currentCroppWidth=195*this.frame:this.isFinished=!0,this.draw()}getPosition(){return this.position}}const et="/chronicles-adventure/images/droneBullet.png",gi=new Image;gi.src=et;class ht{constructor(t,o,p,d){h(this,"position");h(this,"velocity");h(this,"width");h(this,"height");this.position=t,this.velocity=o,this.width=p,this.height=d}draw(){r.drawImage(gi,this.position.x,this.position.y,this.width,this.height)}update(){this.draw(),this.position.x+=this.velocity.velocityX,this.position.y+=this.velocity.velocityY}}const st="/chronicles-adventure/images/drone.png",ot="/chronicles-adventure/sounds/droneBullet.mp3",ui=new Image;ui.src=st;const oi=new Audio(ot);class nt{constructor(t,o,p,d){h(this,"position");h(this,"velocity");h(this,"width");h(this,"height");h(this,"offsetX");h(this,"offsetY");h(this,"bullets");h(this,"lastShootTime");h(this,"shootInterval");h(this,"frame");h(this,"frameInterval");h(this,"frameTimer");h(this,"currentCroppWidth");h(this,"currentCropHeight");h(this,"cropWidth");h(this,"cropHeight");this.position=t,this.velocity=o,this.width=p,this.height=d,this.offsetX=0,this.offsetY=-100,this.bullets=[],this.lastShootTime=0,this.shootInterval=300,this.frame=0,this.frameInterval=10,this.frameTimer=0,this.currentCroppWidth=0,this.currentCropHeight=0,this.cropWidth=143,this.cropHeight=79}draw(){r.drawImage(ui,this.currentCroppWidth,this.currentCropHeight,this.cropWidth,this.cropHeight,this.position.x,this.position.y,this.width,this.height)}update(){this.position.x=c.position.x+this.offsetX,this.position.y=c.position.y+this.offsetY,this.draw(),this.frameTimer++,this.frameTimer>=this.frameInterval&&(this.currentCroppWidth=143*this.frame,this.frame++,this.frame>10&&(this.frame=0),this.frameTimer=0);const t=Date.now();t-this.lastShootTime>=this.shootInterval&&(this.shoot(),this.lastShootTime=t),this.bullets.forEach((o,p)=>{o.update(),oi.play(),oi.volume=.3,m.forEach((d,g)=>{zi(o,d)&&(new Audio(j).play(),m.splice(g,1),this.bullets.splice(p,1))})}),this.bullets.forEach((o,p)=>{o.update(),E.forEach((d,g)=>{$i(o,d)&&(new Audio(j).play(),E.splice(g,1),this.bullets.splice(p,1))})})}shoot(){let d;c.currentSprite===c.sprites.run.right||c.currentSprite===c.sprites.shootRight.right?d={velocityX:-20,velocityY:7}:d={velocityX:20,velocityY:7};const g={x:this.position.x+this.width*1/8,y:this.position.y+this.height/2};this.bullets.push(new ht(g,d,50,50))}}class rt{constructor({x:t,y:o,image:p}){h(this,"position");h(this,"image");h(this,"width");h(this,"height");this.position={x:t,y:o},this.image=p,this.width=s.width,this.height=s.height}draw(){r.drawImage(this.image,this.position.x,this.position.y,this.width,this.height)}}const fi=new Image;fi.src=Ti;const s=document.querySelector("canvas"),r=s.getContext("2d");s.width=window.innerWidth;s.height=window.innerHeight;const e=new Image;e.src=Ei;const wi=new Image;wi.src=Ci;const a=new Image;a.src=Wi;const yi=new Audio(Hi);yi.volume=.4;const Z=new Audio(bi);Z.volume=.4;const b=new Audio(Li);b.volume=.9;Z.loop=!0;let c,m=[],E=[],W=[],H=[],v=[],D=[],S=[],Y=[],mi;const w={d:{pressed:!1},a:{pressed:!1},shoot:{pressed:!1},jump:{pressed:!1}};let T=0,V=!1,ni=!1,R=5,P=!1,L=!1,xi=!1,K=!0,M=0,G=!1,ri=!1,N=!1,X=window.location.pathname.includes("levelEditor.html"),C="platform",I=null;function vi(){if(R<=0){P=!0;return}c=new Fi,new rt({x:0,y:0,image:fi}),mi=new nt({x:c.position.x,y:c.position.y-100},{velocityX:0,velocityY:0},50,50),v=[new l({x:0,y:s.height-e.height,image:e}),new l({x:e.width,y:s.height-e.height,image:e}),new l({x:e.width*2+n,y:s.height-e.height,image:e}),new l({x:e.width*3+n*2,y:s.height-e.height*2,image:e}),new l({x:e.width*4+n*3,y:s.height-e.height*3,image:e}),new l({x:e.width*5+n*4,y:s.height-e.height*4,image:e}),new l({x:e.width*6+n*5+n,y:s.height-e.height*3,image:e}),new l({x:e.width*7+n*6+n*2,y:s.height-e.height*3,image:e}),new l({x:e.width*8+n*7+n*3,y:s.height-e.height*2,image:e}),new l({x:e.width*9+n*8+n*4,y:s.height-e.height,image:e}),new l({x:e.width*10+n*9+n*4,y:s.height-e.height*2,image:e}),new l({x:e.width*11+n*10+n*4,y:s.height-e.height,image:e}),new l({x:e.width*12+n*11+n*4,y:s.height-e.height,image:e}),new l({x:e.width*13+n*12+n*3,y:s.height-e.height,image:e}),new l({x:e.width*14+n*13+n*3,y:s.height-e.height*2,image:e}),new l({x:e.width*15+n*14+n*3,y:s.height-e.height*3,image:e}),new l({x:e.width*16+n*15+n*3,y:s.height-e.height*2,image:e}),new l({x:e.width*17+n*16+n*3,y:s.height-e.height*3,image:e}),new l({x:e.width*18+n*17+n*3,y:s.height-e.height,image:e}),new l({x:e.width*19+n*18+n*4,y:s.height-e.height,image:e}),new l({x:e.width*20+n*19+n*5,y:s.height-e.height,image:e}),new l({x:e.width*21+n*20+n*6,y:s.height-e.height,image:e})],D=[new f({x:0,y:0,image:wi}),new f({x:300,y:s.height-a.height,image:a}),new f({x:300+y,y:s.height-a.height,image:a}),new f({x:300+y*2,y:s.height-a.height,image:a}),new f({x:300+y*3,y:s.height-a.height,image:a}),new f({x:300+y*5,y:s.height-a.height,image:a}),new f({x:300+y*7,y:s.height-a.height,image:a}),new f({x:300+y*9,y:s.height-a.height,image:a}),new f({x:300+y*10,y:s.height-a.height,image:a}),new f({x:300+y*12,y:s.height-a.height,image:a}),new f({x:300+y*13,y:s.height-a.height,image:a}),new f({x:300+y*14,y:s.height-a.height,image:a}),new f({x:300+y*15,y:s.height-a.height,image:a}),new f({x:300+y*16,y:s.height-a.height,image:a}),new f({x:300+y*17,y:s.height-a.height,image:a}),new f({x:300+y*18,y:s.height-a.height,image:a}),new f({x:300+y*19,y:s.height-a.height,image:a}),new f({x:300+y*20,y:s.height-a.height,image:a}),new f({x:300+y*21,y:s.height-a.height,image:a}),new f({x:300+y*22,y:s.height-a.height,image:a})],S=[new u({x:0+e.width/2,y:s.height-e.height*2}),new u({x:e.width+e.width/2,y:s.height-e.height*2}),new u({x:e.width*2+n+e.width/2,y:s.height-e.height*2}),new u({x:e.width*3+n*2+e.width/2,y:s.height-e.height*3}),new u({x:e.width*4+n*3+e.width/2,y:s.height-e.height*4}),new u({x:e.width*5+n*4+e.width/2,y:s.height-e.height*5}),new u({x:e.width*6+n*5+n+e.width/2,y:s.height-e.height*4}),new u({x:e.width*7+n*6+n*2+e.width/2,y:s.height-e.height*4}),new u({x:e.width*8+n*7+n*3+e.width/2,y:s.height-e.height*3}),new u({x:e.width*9+n*8+n*4+e.width/2,y:s.height-e.height*3}),new u({x:e.width*10+n*9+n*4+e.width/2,y:s.height-e.height*2}),new u({x:e.width*11+n*10+n*4+e.width/2,y:s.height-e.height*2}),new u({x:e.width*12+n*11+n*4+e.width/2,y:s.height-e.height*2}),new u({x:e.width*13+n*12+n*3+e.width/2,y:s.height-e.height*2}),new u({x:e.width*14+n*13+n*3+e.width/2,y:s.height-e.height*2}),new u({x:e.width*15+n*14+n*3+e.width/2,y:s.height-e.height*3}),new u({x:e.width*16+n*15+n*3+e.width/2,y:s.height-e.height*2}),new u({x:e.width*17+n*16+n*3+e.width/2,y:s.height-e.height*3})],T=0}e.onload=()=>{vi(),_(),ni||(ni=!0,setInterval(()=>{!P&&!L&&m.push(new B({x:c.position.x-Ai,y:c.position.y-ti}))},1e3),setInterval(()=>{!P&&!L&&E.push(new Gi({x:c.position.x+Oi,y:c.position.y-ti}))},1e3))};function ci(){r.fillStyle="Green",r.font="bold 70px Arial",r.fillText("Victory",r.canvas.width/2-100,r.canvas.height/2),P=!1,xi=!0}function ct(){r.fillStyle="White",r.font="bold 50px Arial",r.fillText("Game Over",r.canvas.width/2-100,r.canvas.height/2)}function _(){if(P){ct();return}if(xi){ci();return}if(L){r.fillStyle="rgba(0, 0, 0, 0.5)",r.fillRect(0,0,s.width,s.height),r.fillStyle="white",r.font="bold 70px Arial",r.fillText("Paused",s.width/2-100,s.height/2);return}if(window.requestAnimationFrame(_),r.fillStyle="white",r.clearRect(0,0,s.width,s.height),r.fillRect(0,0,s.width,s.height),Z.play(),D.forEach(i=>{i.draw()}),S.forEach(i=>{i.update()}),v.forEach(i=>{i.draw()}),X)c.update(),pi(),v.forEach(i=>{hi(c,i)&&(c.velocity.y=0)});else{if(c.update(),c.position.x>500&&!G&&(G=!0,N=!0,setTimeout(()=>{ri=!0,N=!1},5e3)),G&&ri&&mi.update(),pi(),W.forEach((i,t)=>{i.update(),m.forEach((o,p)=>{qi(i,o)&&(new Audio(j).play(),m.splice(p,1),W.splice(t,1),M+=10)})}),W.forEach((i,t)=>{i.update(),E.forEach((o,p)=>{Ji(i,o)&&(new Audio(j).play(),E.splice(p,1),W.splice(t,1),M+=10)})}),Y.forEach(i=>{i.update()}),Y=Y.filter(i=>!i.isFinished),W.forEach((i,t)=>{i.update(),H.forEach((o,p)=>{if(Ki(i,o)){new Audio(ki).play();const g=new tt({x:o.position.x,y:o.position.y});Y.push(g),H.splice(p,1),W.splice(t,1)}})}),H.forEach(i=>{i.update(),Vi(i,c)&&(b.play(),console.log("you lose"),A())}),H.forEach((i,t)=>{i.update(),i.position.x+i.width<0&&H.splice(t,1)}),m.forEach(i=>{i.update(),v.forEach(t=>{si(i,t)&&(i.velocity.y=0)})}),E.forEach(i=>{i.update(),v.forEach(t=>{Ui(i,t)&&(i.velocity.y=0)})}),m.forEach(i=>{Qi(c,i)&&(b.play(),console.log("you lose"),A())}),E.forEach(i=>{Zi(c,i)&&(b.play(),console.log("you lose"),A())}),S.forEach(i=>{_i(c,i)&&(b.play(),console.log("you lose"),A())}),v.forEach(i=>{hi(c,i)&&(c.velocity.y=0)}),m.forEach(i=>{i.update(),yi.play(),v.forEach(t=>{si(i,t)&&(i.velocity.y=0)})}),T>F){ci();return}c.position.y>s.height&&(b.play(),console.log("you lose"),A()),r.fillStyle="white",r.font="20px Arial",r.fillText(`Lives: ${R}`,20,50),r.fillText(`Survival Score: ${M}`,s.width-200,50),K&&(r.fillStyle="white",r.font="14px Arial",r.fillText("Use keys to Play:",20,80),r.fillText("A: Move Left",30,100),r.fillText("D: Move Right",30,120),r.fillText("Space: Jump",30,140),r.fillText("Enter: Fire",30,160),r.fillText("P: Pause",30,180),r.fillText("Press 'G' to toggle guidance",20,220)),N&&(r.fillStyle="White",r.font="25px Arial",r.fillText("Friendly fighter drone is on the way...",r.canvas.width/2-200,r.canvas.height/2-50))}}function pi(){c.velocity.x=0,w.d.pressed&&c.position.x<500||w.d.pressed&&T===F&&c.position.x<F?c.velocity.x=x:w.a.pressed&&c.position.x>100||w.a.pressed&&T===0&&c.position.x>0?c.velocity.x=-x:(c.velocity.x=0,w.d.pressed&&T<F?(T+=x,v.forEach(i=>{i.position.x-=x}),D.forEach(i=>{i.position.x-=ii}),m.forEach(i=>{i.position.x-=x}),E.forEach(i=>{i.position.x-=x}),H.forEach(i=>{i.position.x-=x}),S.forEach(i=>{i.position.x-=x})):w.a.pressed&&T>0&&(T-=x,v.forEach(i=>{i.position.x+=x}),D.forEach(i=>{i.position.x+=ii}),m.forEach(i=>{i.position.x+=x}),E.forEach(i=>{i.position.x+=x}),H.forEach(i=>{i.position.x+=x}),S.forEach(i=>{i.position.x+=x})))}function A(){R-=1,R>0?vi():P=!0}window.addEventListener("keydown",i=>{switch(i.key){case"a":case"A":{w.a.pressed=!0,c.currentSprite=c.sprites.runLeft.left;break}case"d":case"D":{w.d.pressed=!0,c.currentSprite=c.sprites.run.right;break}case" ":{if(w.jump.pressed=!0,c.velocity.y!=0)break;c.velocity.y=-14,console.log(i.key);break}case"Enter":{if(!V){w.shoot.pressed=!0,V=!0;const t=new Audio(Pi);t.volume=.2,t.play(),c.currentSprite===c.sprites.runLeft.left?W.push(new ei({x:c.position.x-c.width,y:c.position.y},{velocityX:-10,velocityY:0},100,100)):c.currentSprite===c.sprites.run.right&&W.push(new ei({x:c.position.x+c.width,y:c.position.y},{velocityX:10,velocityY:0},100,100))}break}case"p":case"P":{L=!L,L||_();break}case"g":case"G":{K=!K;break}}});window.addEventListener("keyup",i=>{switch(i.key){case"a":{w.a.pressed=!1,c.currentCroppWidth=290,c.currentCropHeight=65;break}case"d":{w.d.pressed=!1,c.currentCroppWidth=290,c.currentCropHeight=65;break}case"Enter":{w.shoot.pressed=!1,V=!1;break}}});X&&(document.getElementById("selectPlatform").addEventListener("click",()=>{C="platform",U()}),document.getElementById("selectEnemy").addEventListener("click",()=>{C="enemy",U()}),document.getElementById("selectFire").addEventListener("click",()=>{C="fire",U()}),document.getElementById("saveLevel").addEventListener("click",dt),document.getElementById("loadLevel").addEventListener("click",()=>{document.getElementById("fileInput").click()}),document.getElementById("fileInput").addEventListener("change",lt),s.addEventListener("mousedown",i=>{if(X){const t=i.offsetX,o=i.offsetY;I=at(t,o),I||pt(t,o)}}),s.addEventListener("mousemove",i=>{if(X&&I){const t=i.offsetX,o=i.offsetY;I.position.x=t,I.position.y=o}}),s.addEventListener("mouseup",()=>{X&&(I=null)}));function U(){const i=s.width/2,t=s.height/2;C==="platform"?(I=new l({x:i,y:t,image:e}),v.push(I)):C==="enemy"?(I=new B({x:i,y:t}),m.push(I)):C==="fire"&&(I=new u({x:i,y:t}),S.push(I))}function pt(i,t){C==="platform"?v.push(new l({x:i,y:t,image:e})):C==="enemy"?m.push(new B({x:i,y:t})):C==="fire"&&S.push(new u({x:i,y:t}))}function at(i,t){return v.find(o=>i>=o.position.x&&i<=o.position.x+o.width&&t>=o.position.y&&t<=o.position.y+o.height)||m.find(o=>i>=o.position.x&&i<=o.position.x+o.width&&t>=o.position.y&&t<=o.position.y+o.height)||S.find(o=>i>=o.position.x&&i<=o.position.x+o.width&&t>=o.position.y&&t<=o.position.y+o.height)}function dt(){const i={platforms:v.map(p=>({x:p.position.x,y:p.position.y})),enemies:m.map(p=>({x:p.position.x,y:p.position.y})),fires:S.map(p=>({x:p.position.x,y:p.position.y}))},t="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(i)),o=document.createElement("a");o.setAttribute("href",t),o.setAttribute("download","level.json"),document.body.appendChild(o),o.click(),o.remove()}function lt(i){const t=i.target;if(t.files){const o=t.files[0],p=new FileReader;p.onload=d=>{const g=JSON.parse(d.target.result);gt(g)},p.readAsText(o)}}function gt(i){v=i.platforms.map(t=>new l({x:t.x,y:t.y,image:e})),m=i.enemies.map(t=>new B({x:t.x,y:t.y})),S=i.fires.map(t=>new u({x:t.x,y:t.y}))}
